<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ringle Voice Insights</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- WordCloud.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wordcloud2.js/1.2.2/wordcloud2.min.js"></script>
    <style>
        html, body { height: 100%; }
        body {
            background-color: #f8f9fa;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .page-shell {
            flex: 1 1 auto;
            overflow-y: auto;
        }
        .page-shell .container {
            padding-bottom: 32px;
        }
        .card { border: none; box-shadow: 0 2px 4px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .stat-value { font-size: 2rem; font-weight: bold; color: #2c3e50; }
        .stat-label { font-size: 0.9rem; color: #7f8c8d; }
        .sentiment-badge { padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; color: white; }
        .sentiment-positive { background-color: #2ecc71; }
        .sentiment-neutral { background-color: #95a5a6; }
        .sentiment-negative { background-color: #e74c3c; }
        .source-badge { background-color: #3498db; color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem; }
        .timeline-tab { cursor: pointer; padding: 10px 20px; border-bottom: 2px solid transparent; }
        .timeline-tab.active { border-bottom-color: #3498db; color: #3498db; font-weight: bold; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="#">Ringle Voice Insights</a>
        </div>
    </nav>

    <div class="page-shell">
        <div class="container">
        <!-- KPIs -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card p-3 text-center">
                    <div class="stat-label">Ringle 평균 평점</div>
                    <div class="stat-value" id="kpi-rating">-</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card p-3 text-center">
                    <div class="stat-label">총 리뷰 수</div>
                    <div class="stat-value" id="kpi-total">-</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card p-3">
                    <div class="stat-label mb-2">감성 분포</div>
                    <div style="height: 100px; position: relative;">
                        <canvas id="sentimentChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card p-3">
                    <div class="stat-label mb-2">워드 클라우드</div>
                    <div style="height: 100px; position: relative;">
                        <canvas id="wordCloudCanvas"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Churn Risk Alerts -->
        <div class="row mb-4" id="churnAlertSection" style="display: none;">
            <div class="col-12">
                <div class="card border-danger">
                    <div class="card-header bg-danger text-white fw-bold">⚠️ 이탈 위험 신호 (Churn Risk)</div>
                    <div class="card-body" id="churnAlertContent"></div>
                </div>
            </div>
        </div>

        <!-- Top Issues -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card p-4">
                    <h5 class="card-title">주요 이슈 (Top Issues)</h5>
                    <div id="topIssuesList" class="row g-3">
                        <div class="col-12 text-center text-muted">데이터를 불러오는 중...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card p-4">
                    <h5 class="card-title">일별 트렌드 (Sentiment Trend)</h5>
                    <canvas id="trendChart" height="80"></canvas>
                </div>
            </div>
        </div>

        <!-- Filters & Table -->
        <div class="card p-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5 class="card-title m-0">리뷰 상세 분석</h5>
                <div class="d-flex gap-2">
                    <select id="yearFilter" class="form-select form-select-sm" onchange="filterReviews()">
                        <option value="all">전체 기간</option>
                        <option value="2024">2024년</option>
                        <option value="2023">2023년</option>
                    </select>
                    <select id="sourceFilter" class="form-select form-select-sm" onchange="filterReviews()">
                        <option value="all">모든 채널</option>
                        <option value="AppStore">App Store</option>
                        <option value="PlayStore">Play Store</option>
                    </select>
                    <select id="sentimentFilter" class="form-select form-select-sm" onchange="filterReviews()">
                        <option value="all">모든 감성</option>
                        <option value="positive">긍정</option>
                        <option value="negative">부정</option>
                    </select>
                    <button class="btn btn-sm btn-success ms-2" onclick="exportToCSV()">
                        CSV 내보내기
                    </button>
                </div>
            </div>
            
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>기간</th>
                            <th>출처</th>
                            <th>카테고리</th>
                            <th>내용</th>
                            <th>감성</th>
                        </tr>
                    </thead>
                    <tbody id="reviewTableBody">
                        <!-- JS로 렌더링 -->
                    </tbody>
                </table>
            </div>
        </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="scripts/main.js"></script>
</body>
</html>
